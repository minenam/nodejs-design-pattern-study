## chapter 4~5 느낀점

- chapter 4에서는 몇 번에 거쳐 리팩토링을 한다.

1. early return으로 분기 depth 줄이기. (들여쓰는 블록 줄여서 가독성 개선)
2. sequential 한 callback의 경우 함수 분리 (+지난 번에 배운 nextTick 활용하여 zalgo 제거)
3. 병렬 처리 (forEach + done count사용)
4. 스케쥴러 기반 구현

어쩌면 노드를 좀 쓰다보면 자연스레 대부분 쓰게되는 패턴인듯하다.
4번은 그냥 일반적으로 queue, scheduler을 쓰면 만나는 패턴인듯함.

- chapter 5에서는 promisify와 async await을 다룬다.
- 현대의 node 문법에서는 편리하게 비동기 처리에 최적화된 코드를 짤 수 있음을 보여준다.
- 내가 추가로 찾아본 것은 promise vs async await이 정말 그냥 js 코드로 구현 가능한 수준의 syntactic sugaer인지였는데,
  아래와 같은 차이점이 있다고 한다...

  > 🔹 2. 엔진 수준 차이 (최적화 관점)
  > 엔진(V8, SpiderMonkey 등)은 async/await을 내부적으로 다음과 같이 처리합니다:
  >
  > - async 함수 → 상태머신(state machine)으로 변환
  >   실제로는 Promise 체이닝으로 바꿔 실행합니다.
  >   V8은 이를 inline promise로 최적화해 불필요한 중간 객체 생성을 줄입니다.
  > - await 문은 “마이크로태스크 큐(microtask queue)”에 등록
  >   .then()과 같은 스케줄링을 사용하지만, 내부적으로 좀 더 효율적으로 처리됩니다.

chapter 4, 5는 거의 대부분의 node js 개발자면 이미 알고 있는 내용이 아닐까 싶다.
